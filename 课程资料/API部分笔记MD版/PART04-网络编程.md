# 网络编程

## 1 Socket

### 1.1 IP和端口号

#### 1.1.1 什么是IP

IP是根据TCP/IP协议划定,由32位二进制数组成,而且在因特网上是唯一的数值

例如:某台计算机,连上网的IP是:

11010101 01001001 11110000 11001100

为了便于记忆,会将这32位二进制数,每8位一组,每段之间用小数点分割

11010101.01001001.11110000.11001100

再将每八位转化为十进制

213.73.240.204

#### 1.1.2 如何查看自己电脑的ip

1. 按win+R, 输入cmd,打开dos窗口

2. 在dos窗口输入ipconfig

<img src="https://gitee.com/paida-spitting-star/image/raw/master/image-20230506212751768.png" alt="image-20230506212751768" style="border:solid"/>

### 1.2 什么是端口号

- 端口号(port number)就是计算机为了给每个网络程序分配一个独一无二的区别符,有了这些端口号,就可以准确定位到具体的程序。
- 端口号是个整数,范围0-65535,分为周知端口和动态端口
  - 周知端口就是众所周知的端口,是端口号中的明星,本身的存在就是有自身用途,这些端口我们一般不使用,范围是0-1023。
  - 动态端口,剩下的端口号都是动态端口,动态端口的意思就是将这些端口动态的分配给每个需要端口号的程序,当开启一个程序时,就分配给它一个端口

## 2 Socket概述

在计算机领域中,Socket也被称为套接字编程,它是计算机之间进行通信的一种约定或者说是一种方式。

应用程序可以通过它发送或者接收数据,可以对其发送过来的内容像处理文件一样,打开、关闭或者读写等操作,套接字允许应用程序将I/O插入到互联网上,并与网络中的其他程序进行通信。

### 2.1 Socket常用方法

#### 2.1.1 服务器端ServerSocket

在服务器端选择一个端口号,然后在指定的端口号上等待客户端发起的连接

构造方法:

```
ServerSocket(int port) 创建一个绑定特定端口号的服务器套接字
accept() 侦听并接受到发送到此套接字的连接
close() 关闭此套接字
```

#### 2.1.2 客户端Socket

构造方法:

```
Socket(String host,int port) 创建一个套接字,并且连接到host,并且绑定端口号
close() 关闭此套接字
getInputStream() 返回此套接字的输入流
getOutputStram() 返回此套接字的输出流
```

### 2.2 聊天室

#### 2.2.1 初始化代码 

1. 创建socket包,并在包下创建Client类和Server类
2. 在Client类中定义如下内容

- **构造器**的作用主要是用于初始化客户端的内容,主要是用于做前期准备
- **start方法**的作用主要是用于执行客户端的工作逻辑
- **main方法**中只用于书写流程调用内容

```java
package cn.tedu.socket;

/**
 * 聊天室的客户端
 */
public class Client {
    /**
     * 初始化客户端
     */
    public Client() {
    }

    /**
     * 客户端开始工作的方法
     */
    public void start() {

    }

    public static void main(String[] args) {
        Client client = new Client();
        client.start();
    }
}
```

3. 在Client中声明[Socket实例](#2 Socket概述),用于搭建TCP连接,并在构造器中实例化该socket

- 其中的[IP]()和端口号可以参考上面的内容

```java
/**
 * java.net.Socket 套接字,原意是插座
 * Socket封装了TCP协议的通信细节,我们使用它就可以与远端计算机建立TCP连接,并基于一堆流的IO操作完成
 * 与远端计算机的数据交互
 */
private Socket socket;

/**
 * 初始化客户端
 */
public Client() {
    try {
        System.out.println("正在连接服务器...");
        /*
         * 实例化Socket时,需要传入两个参数:
         * ①要链接的远端计算机的IP地址
         * 连接的计算机IP分为两种情况:
         *  1)如果连接的是非本机,则需要查询对方的IP地址,进行连接
         *  2)如果连接的是本机,则可以选取如下的值:
         *      i. 真实IP(通过ipconfig查询出来的)
         *      ii. 127.0.0.1(会自动映射本机的真实IP)
         *      iii. localhost(是127.0.0.1的域名)
         * ②要链接的远端计算机的端口
         */
        socket = new Socket("localhost",8088);
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

#### 2.2.3 测试

**切记先运行服务器,****后运行客户端！！！**

#### 2.2.4 常见问题:   

表示端口被占用,解决方式：换个没有被占用的端口     

表示连接被拒绝,因为服务器没启动,解决方式:先启动服务器,然后再启动客户端

